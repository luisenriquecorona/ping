<!DOCTYPE html PUBLIC "-//IETF//DTD HTML 2.0//EN">
<html>
<head>
<title>Ping a una ip o host</title>
</head>
<?php

$max_count = 10; //numero maximo de pings 
$unix      =  1; //si tu host donde vas a alojar este script es unix pon esto en 1 (la mayoria usa unix)
$windows   =  0; //si tu host donde vas a alojar este script es windows pon esto en 1 y en 0 la variable $unix

$register_globals = (bool) ini_get('register_gobals');
$system = ini_get('system');
$unix = (bool) $unix;
$win  = (bool)  $windows;

If ($register_globals)
{
   $ip = getenv(REMOTE_ADDR);
   $self = $PHP_SELF;
}
else
{
   $submit = $_GET['submit'];
   $count  = $_GET['count'];
   $host   = $_GET['host'];
   $ip     = $_SERVER['REMOTE_ADDR'];
   $self   = $_SERVER['PHP_SELF'];
};

If ($submit == "Ping!")
{

   If ($count > $max_count)
   {
      echo 'el numero maximo es : '.$max_count;
      echo '<a href="'.$self.'">Back</a>';
   }
   else
   {

      $host= preg_replace ("/[^A-Za-z0-9.-]/","",$host);
      $count= preg_replace ("/[^0-9]/","",$count);
      echo '<body bgcolor="#FFFFFF" text="#000000"></body>';
      echo("Ping Output:<br>");
      echo '<pre>';           
  
      if ($unix)
      {
         system ("ping -c$count -w$count $host");
         system("killall ping");
      }
      else
      {
         system("ping -n $count $host");
      }
      echo '</pre>';
    }
}
else
{
    echo '<body bgcolor="#FFFFFF" text="#000000"></body>';
    echo '<p><font size="2">tu IP es: '.$ip.'</font></p>';
    echo '<form methode="post" action="'.$self.'">';
    echo '   ponga una IP o Host <input type="text" name="host" value="'.$ip.'"></input>';
    echo '   numero de envios (4 recomendado) <input type="text" name="count" size="2" value="4"></input>';
    echo '   <input type="submit" name="submit" value="Ping!"></input>';
    echo '</form>';
    echo '<br><b>'.$system.'</b>';
    echo '</body></html>';
}
?>
